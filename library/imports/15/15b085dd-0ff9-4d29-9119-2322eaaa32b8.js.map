{"version":3,"sources":["assets/goap/GotoToiletAction.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,4DAA0D;AAC1D,+DAA6D;AAC7D,kDAA4C;AAC5C,uDAAqD;AAErD;IAAsC,oCAAU;IAI5C;QAAA,YACI,iBAAO,SAEV;QANO,WAAK,GAAY,KAAK,CAAA;QACtB,eAAS,GAAW,CAAC,CAAA;QACrB,kBAAY,GAAW,CAAC,CAAA,CAAC,UAAU;QAGvC,KAAI,CAAC,SAAS,CAAC,mCAAgB,CAAC,UAAU,EAAE,IAAI,CAAC,CAAA;;IACrD,CAAC;IAEM,gCAAK,GAAZ;QACI,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,IAAI,CAAC,SAAS,GAAG,CAAC,CAAA;IACtB,CAAC;IAEM,iCAAM,GAAb;QACI,OAAO,IAAI,CAAC,KAAK,CAAA;IACrB,CAAC;IAEM,0CAAe,GAAtB;QACI,OAAO,IAAI,CAAA;IACf,CAAC;IACM,sDAA2B,GAAlC,UAAmC,EAAW;QAC1C,IAAI,CAAC,MAAM,GAAG,yBAAW,CAAC,YAAY,CAAA;QACtC,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAA;QAC1B,iDAAiD;QACjD,sDAAsD;QACtD,qCAAqC;QACrC,+BAA+B;QAE/B,4BAA4B;QAC5B,0BAA0B;QAC1B,uCAAuC;QACvC,oBAAoB;QACpB,8CAA8C;QAC9C,YAAY;QACZ,yCAAyC;QACzC,mDAAmD;QACnD,8BAA8B;QAC9B,sCAAsC;QACtC,qBAAqB;QACrB,yBAAyB;QACzB,MAAM;QACN,KAAK;QACL,IAAI;QACJ,uBAAuB;QACvB,iBAAiB;QAEjB,yBAAyB;QAEzB,0BAA0B;IAC9B,CAAC;IAEM,kCAAO,GAAd,UAAe,IAAa;QACxB,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC;YAAE,IAAI,CAAC,SAAS,GAAG,kBAAQ,CAAC,OAAO,EAAE,CAAA;QAE5D,IAAI,kBAAQ,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE;YACzD,sDAAsD;YACtD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAA;SACpB;QACD,OAAO,IAAI,CAAA;IACf,CAAC;IACL,uBAAC;AAAD,CA7DA,AA6DC,CA7DqC,uBAAU,GA6D/C;AA7DY,4CAAgB","file":"","sourceRoot":"/","sourcesContent":["import { GoapAction } from \"../src/app/ai/goap/GoapAction\"\nimport { Environment } from \"../src/app/gamedata/Environment\"\nimport TimeUtil from \"../src/utils/TimeUtil\"\nimport { ActionDataStatus } from \"./ActionDataStatus\"\n\nexport class GotoToiletAction extends GoapAction {\n    private bDone: boolean = false\n    private startTime: number = 0\n    private workDuration: number = 2 // seconds\n    public constructor() {\n        super()\n        this.addEffect(ActionDataStatus.isTolietOk, true)\n    }\n\n    public reset(): void {\n        this.bDone = false\n        this.startTime = 0\n    }\n\n    public isDone() {\n        return this.bDone\n    }\n\n    public requiresInRange() {\n        return true\n    }\n    public checkProceduralPrecondition(go: cc.Node): boolean {\n        this.target = Environment.toiletTarget\n        return this.target != null\n        // // TODO:find the nearest tree that we can chop\n        // let trees: TreeComponent[] = Environment.treeComps;\n        // let closest: TreeComponent = null;\n        // let closestDist: number = 0;\n\n        // for (let tree of trees) {\n        // \tif (closest == null) {\n        // \t\t// first one, so choose it for now\n        // \t\tclosest = tree;\n        // \t\tclosestDist = tree.distanceSquare(agent);\n        // \t} else {\n        // \t\t// is this one closer than the last?\n        // \t\tlet dist: number = tree.distanceSquare(agent);\n        // \t\tif (dist < closestDist) {\n        // \t\t\t// we found a closer one, use it\n        // \t\t\tclosest = tree;\n        // \t\t\tclosestDist = dist;\n        // \t\t}\n        // \t}\n        // }\n        // if (closest == null)\n        // \treturn false;\n\n        // this.target = closest;\n\n        // return closest != null;\n    }\n\n    public perform(node: cc.Node): boolean {\n        if (this.startTime == 0) this.startTime = TimeUtil.getTime()\n\n        if (TimeUtil.getTime() - this.startTime > this.workDuration) {\n            //entity.memory.set(ActionDataStatus.isTolietOk, true)\n            this.bDone = true\n        }\n        return true\n    }\n}\n"]}