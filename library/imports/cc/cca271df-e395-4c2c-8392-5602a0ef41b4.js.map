{"version":3,"sources":["assets/shopping/ActionBuyProduct.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,4DAA0D;AAC1D,iCAA+B;AAC/B,6CAAuC;AAGvC;IAA8C,oCAAU;IAIpD,0BAAY,KAAK;QAAjB,YACI,iBAAO,SAIV;QARS,WAAK,GAAY,KAAK,CAAA;QAK5B,KAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,KAAI,CAAC,eAAe,CAAC,YAAY,GAAG,KAAK,EAAE,KAAK,CAAC,CAAA;QACjD,KAAI,CAAC,SAAS,CAAC,YAAY,GAAG,KAAK,EAAE,IAAI,CAAC,CAAA;;IAC9C,CAAC;IAED,gCAAK,GAAL;QACI,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;IACtB,CAAC;IAED,iCAAM,GAAN;QACI,OAAO,IAAI,CAAC,KAAK,CAAA;IACrB,CAAC;IAED,sDAA2B,GAA3B,UAA4B,EAAW;QACnC,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,EAAE;YACjB,IAAI,qBAAW,CAAC,UAAU,EAAE;gBACxB,IAAI,CAAC,MAAM,GAAG,qBAAW,CAAC,UAAU,CAAA;gBACpC,OAAO,IAAI,CAAA;aACd;SACJ;aAAM,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,EAAE;YACxB,IAAI,qBAAW,CAAC,WAAW,EAAE;gBACzB,IAAI,CAAC,MAAM,GAAG,qBAAW,CAAC,WAAW,CAAA;gBACrC,OAAO,IAAI,CAAA;aACd;SACJ;QACD,OAAO,KAAK,CAAA;IAChB,CAAC;IAED,kCAAO,GAAP,UAAQ,IAAa;QACjB,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;YAC7B,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;YAC5B,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,aAAK,CAAC,CAAA;YACpC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;YAC/B,IAAI,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBAClC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAA;gBACjB,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;aACzD;SACJ;QACD,OAAO,IAAI,CAAA;IACf,CAAC;IAED,0CAAe,GAAf;QACI,OAAO,IAAI,CAAA;IACf,CAAC;IACL,uBAAC;AAAD,CAlDA,AAkDC,CAlD6C,uBAAU,GAkDvD","file":"","sourceRoot":"/","sourcesContent":["import { GoapAction } from \"../src/app/ai/goap/GoapAction\"\nimport { Buyer } from \"./Buyer\"\nimport ContextShop from \"./ContextShop\"\nimport GoodsShelf from \"./GoodsShelf\"\n\nexport default class ActionBuyProduct extends GoapAction {\n    protected bDone: boolean = false\n    public target: GoodsShelf\n    private cfgId: number\n    constructor(cfgId) {\n        super()\n        this.cfgId = cfgId\n        this.addPrecondition(\"hasProduct\" + cfgId, false)\n        this.addEffect(\"hasProduct\" + cfgId, true)\n    }\n\n    reset(): void {\n        this.bDone = false\n    }\n\n    isDone(): boolean {\n        return this.bDone\n    }\n\n    checkProceduralPrecondition(go: cc.Node): boolean {\n        if (this.cfgId == 1) {\n            if (ContextShop.goodsShelf) {\n                this.target = ContextShop.goodsShelf\n                return true\n            }\n        } else if (this.cfgId == 2) {\n            if (ContextShop.goodsShelf2) {\n                this.target = ContextShop.goodsShelf2\n                return true\n            }\n        }\n        return false\n    }\n\n    perform(node: cc.Node): boolean {\n        if (this.target.has(this.cfgId)) {\n            this.target.cost(this.cfgId)\n            let buyer = node.getComponent(Buyer)\n            buyer.addProduct(this.cfgId, 1)\n            if (buyer.hasProductFull(this.cfgId)) {\n                this.bDone = true\n                console.log(\"购物完成\", this.target.node.name, this.cfgId)\n            }\n        }\n        return true\n    }\n\n    requiresInRange(): boolean {\n        return true\n    }\n}\n"]}