{"version":3,"sources":["assets\\src\\app\\ai\\fsm\\state\\StateIdle.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAIA,yCAAwC;AACxC,yCAAwC;AAExC;IAA+B,6BAAS;IAAxC;;IAmCA,CAAC;IAjCU,2BAAO,GAAd;IAEA,CAAC;IACD;;;OAGG;IACI,4BAAQ,GAAf,UAAgB,SAAiB;QAC7B,IAAI,KAAK,GAAU,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACzC,IAAI,OAAO,GAAgB,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;QACnD,IAAI,gBAAgB,GAAiB,IAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC;QACtE,sDAAsD;QACtD,gBAAgB;QAEhB,uDAAuD;QACvD,IAAI,UAAU,GAAwB,KAAK,CAAC,aAAa,EAAE,CAAC;QAC5D,IAAI,IAAI,GAAwB,KAAK,CAAC,eAAe,EAAE,CAAC;QAExD,OAAO;QACP,IAAI,IAAI,GAAiB,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,gBAAgB,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;QACjF,IAAI,IAAI,IAAI,IAAI,EAAE;YACd,0BAA0B;YAC1B,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YACnC,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YAE5B,8BAA8B;YAC9B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,qBAAS,CAAC,kBAAkB,CAAC,CAAC;SACxD;aAAM;YACH,6BAA6B;YAC7B,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACvB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,qBAAS,CAAC,SAAS,CAAC,CAAC;SAC/C;IACL,CAAC;IACL,gBAAC;AAAD,CAnCA,AAmCC,CAnC8B,qBAAS,GAmCvC;AAnCY,8BAAS","file":"","sourceRoot":"/","sourcesContent":["import { GoapAction } from \"../../goap/GoapAction\";\r\nimport { GoapAgent } from \"../../goap/GoapAgent\";\r\nimport { GoapPlanner } from \"../../goap/GoapPlanner\";\r\nimport { IGoap } from \"../../goap/IGoap\";\r\nimport { StateBase } from \"./StateBase\";\r\nimport { StateEnum } from \"./StateEnum\";\r\n\r\nexport class StateIdle extends StateBase {\r\n    protected _owner: GoapAgent\r\n    public onEnter() {\r\n\r\n    }\r\n    /**\r\n     * 状态更新 \r\n     * @return \r\n     */\r\n    public onUpdate(timeStamp: number): void {\r\n        let iGoap: IGoap = this.owner.getOwner();\r\n        let planner: GoapPlanner = this.owner.getPlanner();\r\n        let avaliableActions: GoapAction[] = this.owner.getAvaliableActions();\r\n        //console.log(\"avaliableActions: \", avaliableActions);\r\n        // GOAP planning\r\n\r\n        // get the world state and the goal we want to plan for\r\n        let worldState: Map<string, Object> = iGoap.getWorldState();\r\n        let goal: Map<string, Object> = iGoap.createGoalState();\r\n\r\n        // plan\r\n        let plan: GoapAction[] = planner.plan(iGoap, avaliableActions, worldState, goal);\r\n        if (plan != null) {\r\n            // we have a plan, hooray!\r\n            this.owner.setCurrentActions(plan);\r\n            iGoap.planFound(goal, plan);\r\n\r\n            // move to PerformAction state\r\n            this.owner.changeState(StateEnum.StatePerformAction);\r\n        } else {\r\n            //console.log(\"Failed Plan\");\r\n            iGoap.planFailed(goal);\r\n            this.owner.changeState(StateEnum.StateIdle);\r\n        }\r\n    }\r\n}"]}